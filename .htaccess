RewriteEngine On

# Ensure HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Remove .php extension from URL
RewriteCond %{THE_REQUEST} /([^.]+)\.php [NC]
RewriteRule ^ /%1 [L,R=301]

# Internally rewrite clean URLs to .php files
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^([^/]+)/?$ $1.php [L]

# Force UTF-8 encoding
AddDefaultCharset UTF-8
AddCharset UTF-8 .php .html .js .css

# Allow Service Worker from subfolder to control root scope
<Files "sw.js">
    Header set Service-Worker-Allowed "/"
</Files>
